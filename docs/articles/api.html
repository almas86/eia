<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>API details â€¢ eia</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="API details">
<meta property="og:description" content="">
<meta property="og:image" content="http://leonawicz.github.io/eia/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/eia.html">Get Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/categories.html">Categories</a>
    </li>
    <li>
      <a href="../articles/series.html">Time series</a>
    </li>
    <li>
      <a href="../articles/geoset.html">Geosets</a>
    </li>
    <li>
      <a href="../articles/api.html">API details</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leonawicz/eia">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>API details</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leonawicz/eia/blob/master/vignettes/api.Rmd"><code>vignettes/api.Rmd</code></a></small>
      <div class="hidden name"><code>api.Rmd</code></div>

    </div>

    
    
<p>The EIA API can of course impose its own limitations on usage by a given API key. However, <code>eia</code> also helps out by limiting the potential for making unnecessary API calls. It does this in two ways, both of which allow optional configuration:</p>
<ul>
<li>caching API results using session-based memoization</li>
<li>minimum delay between API calls</li>
</ul>
<p>By default the <code>eia</code> package prevents you from accidentally making too many requests too quickly, but it also offers sensible flexibility.</p>
<div id="memoization" class="section level2">
<h2 class="hasAnchor">
<a href="#memoization" class="anchor"></a>Memoization</h2>
<p>All functions in <code>eia</code> that make API calls use memoization by default. They will not make the same API call twice in one R session. A call is made once and the result is cached. Calling the same function with the identical arguments again will only returned the cached result.</p>
<p>This approach limits the potential for accidentally using the EIA API more than necessary. This is fine for most uses cases. However, if you use your API key to access data that is updated very often, or you have a long-running R process such as a Shiny app on a server that may need to periodically update the data associated with a specific API call, you can set <code>cache = FALSE</code>.</p>
<p>Run this example of the same request made with and without memoization. You will notice the cached result by the immediate return.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(eia)</a>
<a class="sourceLine" id="cb1-2" title="2">key &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.getenv">Sys.getenv</a></span>(<span class="st">"EIA_KEY"</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(<span class="kw"><a href="../reference/eia_cats.html">eia_cats</a></span>(key)) <span class="co"># API call; cache result</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(<span class="kw"><a href="../reference/eia_cats.html">eia_cats</a></span>(key)) <span class="co"># read from cache</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(<span class="kw"><a href="../reference/eia_cats.html">eia_cats</a></span>(key, <span class="dt">cache =</span> <span class="ot">FALSE</span>)) <span class="co"># API call</span></a></code></pre></div>
<p>Results are cached in memory for the duration of the R session, but you can clear the cache at any time:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="../reference/eia_clear_cache.html">eia_clear_cache</a></span>()</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(<span class="kw"><a href="../reference/eia_cats.html">eia_cats</a></span>(key))</a></code></pre></div>
<p>This allows you to update the cached result. You can reset the cache for only specific endpoints using the following functions:</p>
<ul>
<li><code>eia_clear_cats</code></li>
<li><code>eia_clear_series</code></li>
<li><code>eia_clear_geoset</code></li>
</ul>
</div>
<div id="anti-dos-measures" class="section level2">
<h2 class="hasAnchor">
<a href="#anti-dos-measures" class="anchor"></a>Anti-DOS measures</h2>
<p>Regardless of rate overall limiting imposed by the EIA API, the <code>eia</code> package sets a minimum wait time of one second between successive API calls. In most cases this is an irrelevant safeguard. Most <code>eia</code> functions make a single API call and requests for data often take a full second anyway once you factor in the subsequent data manipulation in R.</p>
<p>However, there are cases where you might want to make multiple calls back to back programmatically and perhaps you are initially unsure how many requests will be made or how quickly these requests may execute. The default minimum wait between API calls is a precaution that helps you be a good neighbor.</p>
<p>You can turn this off with <code>options</code> if not needed; for example, a case where you know that your API calls will be small in number and you have no reason to be concerned about exceeding the request limits associated with your API key. The default requires you to make an active decision about how to use the API with your own key and API limits in mind.</p>
<p>A call to <code>eia_parent_cats</code> is a good example. This function is recursive, but say you know the number of calls is going to be small; it is overkill to impose the additional wait. Note that in order to show this example, it is necessary to turn off memoization to avoid returned a cached result.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eia_cats.html">eia_parent_cats</a></span>(key, <span class="dv">742</span>, <span class="dt">cache =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt;    0.21    0.14    6.05</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">eia_antidos =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.time">system.time</a></span>(x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eia_cats.html">eia_parent_cats</a></span>(key, <span class="dv">742</span>, <span class="dt">cache =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt;    0.08    0.00    0.91</span></a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10">x</a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;   category_id name                    notes parent_category_id</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;                   &lt;chr&gt; &lt;chr&gt;             </span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; 1 371         EIA Data Sets           ""    &lt;NA&gt;              </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; 2 0           Electricity             ""    371               </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; 3 32          Total consumption (Btu) ""    0                 </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; 4 372         By sector               ""    32                </span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; 5 389         Electric utility        ""    372               </span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; 6 742         Coal                    ""    389</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#memoization">Memoization</a></li>
      <li><a href="#anti-dos-measures">Anti-DOS measures</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://leonawicz.github.io/">Matthew Leonawicz</a>, <a href="https://www.esource.com/"><img src="https://raw.githubusercontent.com/leonawicz/leonawicz.github.io/master/assets/img/esource_logo.png" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
